/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/
(function(){var e=["vs/base/common/buffer","vs/code/browser/workbench/workbench","exports","vs/workbench/workbench.web.api","vs/base/common/uuid","vs/base/common/cancellation","require","vs/base/common/lifecycle","vs/base/parts/request/browser/request","vs/platform/windows/common/windows","vs/base/common/resources","vs/base/browser/browser"];define(e[1],function(r){for(var o=[],t=0,s=r.length;t<s;t++)o[t]=e[r[t]];return o}([6,2,3,4,5,0,7,8,9,10,11]),(function(e,r,o,t,s,a,i,n,c,d,l){"use strict";Object.defineProperty(r,"__esModule",{value:!0});class E{get credentials(){if(!this._credentials){try{const e=window.localStorage.getItem(E.CREDENTIALS_OPENED_KEY);e&&(this._credentials=JSON.parse(e))}catch(e){}Array.isArray(this._credentials)||(this._credentials=[])}return this._credentials}save(){window.localStorage.setItem(E.CREDENTIALS_OPENED_KEY,JSON.stringify(this.credentials))}async getPassword(e,r){return this.doGetPassword(e,r)}async doGetPassword(e,r){
for(const o of this.credentials)if(o.service===e&&("string"!=typeof r||r===o.account))return o.password;return null}async setPassword(e,r,o){this.deletePassword(e,r),this.credentials.push({service:e,account:r,password:o}),this.save()}async deletePassword(e,r){let o=!1;return this._credentials=this.credentials.filter(t=>t.service!==e||t.account!==r||(o=!0,!1)),o&&this.save(),o}async findPassword(e){return this.doGetPassword(e)}async findCredentials(e){return this.credentials.filter(r=>r.service===e).map(({account:e,password:r})=>({account:e,password:r}))}}E.CREDENTIALS_OPENED_KEY="credentials.provider";class u extends i.Disposable{constructor(){super(...arguments),this._onCallback=this._register(new o.Emitter),this.onCallback=this._onCallback.event}create(e){const r=new Map,o=t.generateUuid();r.set(u.QUERY_KEYS.REQUEST_ID,o);const{scheme:s,authority:a,path:i,query:n,fragment:c}=e||{scheme:void 0,authority:void 0,path:void 0,query:void 0,fragment:void 0};return s&&r.set(u.QUERY_KEYS.SCHEME,s),
a&&r.set(u.QUERY_KEYS.AUTHORITY,a),i&&r.set(u.QUERY_KEYS.PATH,i),n&&r.set(u.QUERY_KEYS.QUERY,n),c&&r.set(u.QUERY_KEYS.FRAGMENT,c),this.periodicFetchCallback(o,Date.now()),this.doCreateUri("/callback",r)}async periodicFetchCallback(e,r){const t=new Map;t.set(u.QUERY_KEYS.REQUEST_ID,e);const i=await n.request({url:this.doCreateUri("/fetch-callback",t).toString(!0)},s.CancellationToken.None),c=await a.streamToBuffer(i.stream);if(c.byteLength>0)try{this._onCallback.fire(o.URI.revive(JSON.parse(c.toString())))}catch(e){console.error(e)}else Date.now()-r<u.FETCH_TIMEOUT&&setTimeout(()=>this.periodicFetchCallback(e,r),u.FETCH_INTERVAL)}doCreateUri(e,r){let t=void 0;if(r){let e=0;r.forEach((r,o)=>{t||(t="");const s=0==e++?"":"&";t+=`${s}${o}=${encodeURIComponent(r)}`})}return o.URI.parse(window.location.href).with({path:e,query:t})}}u.FETCH_INTERVAL=500,u.FETCH_TIMEOUT=3e5,u.QUERY_KEYS={REQUEST_ID:"vscode-requestId",SCHEME:"vscode-scheme",AUTHORITY:"vscode-authority",PATH:"vscode-path",QUERY:"vscode-query",
FRAGMENT:"vscode-fragment"};class h{constructor(e,r){this.workspace=e,this.payload=r}async open(e,r){var o,t;if((null===(o=r)||void 0===o?void 0:o.reuse)&&!r.payload&&this.isSame(this.workspace,e))return;const s=this.createTargetUrl(e,r);s&&((null===(t=r)||void 0===t?void 0:t.reuse)?window.location.href=s:l.isStandalone?window.open(s,"_blank","toolbar=no"):window.open(s))}createTargetUrl(e,r){var o;let t=void 0;return e?c.isFolderToOpen(e)?t=`${document.location.origin}${document.location.pathname}?${h.QUERY_PARAM_FOLDER}=${encodeURIComponent(e.folderUri.toString())}`:c.isWorkspaceToOpen(e)&&(t=`${document.location.origin}${document.location.pathname}?${h.QUERY_PARAM_WORKSPACE}=${encodeURIComponent(e.workspaceUri.toString())}`):t=`${document.location.origin}${document.location.pathname}?${h.QUERY_PARAM_EMPTY_WINDOW}=true`,(null===(o=r)||void 0===o?void 0:o.payload)&&(t+=`&${h.QUERY_PARAM_PAYLOAD}=${encodeURIComponent(JSON.stringify(r.payload))}`),t}isSame(e,r){
return e&&r?c.isFolderToOpen(e)&&c.isFolderToOpen(r)?d.isEqual(e.folderUri,r.folderUri):!(!c.isWorkspaceToOpen(e)||!c.isWorkspaceToOpen(r))&&d.isEqual(e.workspaceUri,r.workspaceUri):e===r}}h.QUERY_PARAM_EMPTY_WINDOW="ew",h.QUERY_PARAM_FOLDER="folder",h.QUERY_PARAM_WORKSPACE="workspace",h.QUERY_PARAM_PAYLOAD="payload",function(){const e=document.getElementById("vscode-workbench-web-configuration"),r=e?e.getAttribute("data-settings"):void 0;if(!e||!r)throw new Error("Missing web configuration element");const t=JSON.parse(r);Array.isArray(t.staticExtensions)&&t.staticExtensions.forEach(e=>{e.extensionLocation=o.URI.revive(e.extensionLocation)});let s,a=!1,i=Object.create(null);new URL(document.location.href).searchParams.forEach((e,r)=>{switch(r){case h.QUERY_PARAM_FOLDER:s={folderUri:o.URI.parse(e)},a=!0;break;case h.QUERY_PARAM_WORKSPACE:s={workspaceUri:o.URI.parse(e)},a=!0;break;case h.QUERY_PARAM_EMPTY_WINDOW:s=void 0,a=!0;break;case h.QUERY_PARAM_PAYLOAD:i=JSON.parse(e)}}),a||(s=t.folderUri?{
folderUri:o.URI.revive(t.folderUri)}:t.workspaceUri?{workspaceUri:o.URI.revive(t.workspaceUri)}:void 0),o.create(document.body,Object.assign(Object.assign({},t),{workspaceProvider:new h(s,i),urlCallbackProvider:new u,credentialsProvider:new E}))}()}))}).call(this);
//# sourceMappingURL=workbench.js.map
